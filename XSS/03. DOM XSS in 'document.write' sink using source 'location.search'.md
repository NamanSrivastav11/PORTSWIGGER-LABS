## LAB DESCRIPTION

<img width="934" height="469" alt="image" src="https://github.com/user-attachments/assets/de562ab9-835e-47f7-b8fc-cdf773f5524b" />

## SOLUTION

---------------------------------------------

- Reference: https://portswigger.net/web-security/cross-site-scripting
- XSS Cheat sheet: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
- Common sinks for finding XSS Vulnerabilities: https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities

---------------------------------------------

<img width="1683" height="709" alt="image" src="https://github.com/user-attachments/assets/e07c01f6-f27d-4114-8ff7-7961e4e00a1d" />

After performing a search (e.g. `/?search=example`), view the page source.

<img width="1918" height="1110" alt="image" src="https://github.com/user-attachments/assets/c2517c61-b5f9-4d5c-833a-3bcd877e2fc7" />

- The source is `window.location.search`, parsed by `URLSearchParams`, so theattacker fully controls the `query` via the URL.
- The sink is `document.write`, which writes a literal `<img>` tag string into the document, with `query` concatenated into the `src` attribute value without encoding.

---------------------------------------------

> **Exploitation: Breaking out of the attribute and tag**
> As our input lands inside an attribute, we must:\
> - Close the `src` attribute's quotes
> - Close the `<img>` tag
> - Inject a new HTML element that can execute JavaScript via an event handler.
>
> PAYLOAD: `"><script><img title="</script><img src onerror=alert(1)>"></script>`

--------------------------------------------------

When the page loads with this URL, the browser parses the HTML produced by `document.write`

<img width="1349" height="845" alt="image" src="https://github.com/user-attachments/assets/7a458e27-098c-4275-95b3-16cbe4d2f1c6" />

<img width="1348" height="804" alt="image" src="https://github.com/user-attachments/assets/c08fc3de-b16a-4ccd-8331-2194304a90c7" />

Successfully completing the lab.
