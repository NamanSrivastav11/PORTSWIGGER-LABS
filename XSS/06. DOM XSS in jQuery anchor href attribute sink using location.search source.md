## LAB DESCRIPTION

<img width="935" height="440" alt="image" src="https://github.com/user-attachments/assets/b3824047-e5e5-4570-9f50-1b691df0d04a" />

## SOLUTION

---------------------------------------------

- Reference: https://portswigger.net/web-security/cross-site-scripting
- XSS Cheat sheet: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
- Common sinks for finding XSS Vulnerabilities: https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities

---------------------------------------------

<img width="1651" height="1072" alt="image" src="https://github.com/user-attachments/assets/3c4da51b-60ba-4336-aeda-c15bdbad2d44" />

----------------------------------------------------

On the **Submit feedback** page, inspect the HTML around the "Back" link and the scripts.

  <img width="1201" height="940" alt="image" src="https://github.com/user-attachments/assets/41a1a39e-16c5-4907-afb8-7334a415946d" />

**Source**: `window.location.search` (query string) via `URLSearchParams(...).get('returnPath')`.

**Sink**: `$('#backLink').attr("href", ...)` write the `returnPath` directly into the `href` attribute of the `#backlink` anchor.

  <img width="1234" height="567" alt="image" src="https://github.com/user-attachments/assets/911bb390-0160-4d59-813c-c0d2359a1df7" />


## Exploitation

As `returnPath` is written as it is into `href`, we can supply it as a JavaScript URL instead of a normal path.
Which would then allow the `Back` link to alert `document.cookie` when clicked.

> `/feedback?returnPath=javascript:alert(document.cookie)`

<img width="1316" height="918" alt="image" src="https://github.com/user-attachments/assets/3dc23fec-f577-45ed-bfce-8831e5eaa733" />

When the `Back` link is clicked, the browser executes the JavaScript in the `href`, triggering `alert(document.cookie)` and solving the lab.

<img width="1316" height="312" alt="image" src="https://github.com/user-attachments/assets/fe7629d9-a9b5-44ef-b689-226d2abc3fc0" />



