## LAB DESCRIPTION

<img width="906" height="436" alt="image" src="https://github.com/user-attachments/assets/b8fd13e9-cc43-4897-b498-60b3157c5572" />

## SOLUTION

---------------------------------------------

- Reference: https://portswigger.net/web-security/cross-site-scripting
- XSS Cheat sheet: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
- Common sinks for finding XSS Vulnerabilities: https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities

---------------------------------------------

<img width="1267" height="985" alt="image" src="https://github.com/user-attachments/assets/ad46b965-3ab2-4253-a51f-ef7a2568afe8" />

First we will try to search with a dummy word `test` and then observe the page source.

<img width="1800" height="1084" alt="image" src="https://github.com/user-attachments/assets/d8f3d78d-f81c-43d6-827e-f38faea4a7ae" />

> **Source**: `query` comes from `window.location.search` via `URLSearchParams(...).get('search')`
>
> **Sink**: `document.getElementById('sarchMessage').innerHTML = query;`; writes your value as HTML inside the `<span id= "searchMessage"">`.
>

So, our input is being placed directly between `<span id= "searchMessage"">` and `</span>` as HTML, with no encoding.

------------------------------------------

PAYLOAD: `<img src=1 onerror=alert(1)>`

When used as the `search` value, the URL is: `/?search=<img src=1 onerror=alert(1)>

<img width="1652" height="862" alt="image" src="https://github.com/user-attachments/assets/64ef2744-b191-45bd-a742-21b698e48871" />

The JavaScript sets:
  > `query ="<img src=1 onerror=alert(1)>"; document.getElementById('searchMessage').innerHTML = query;`

<img width="1652" height="566" alt="image" src="https://github.com/user-attachments/assets/20fb4954-24b2-4d28-9ee8-59edb8841519" />

The browser tries to load `src=1`, which fails, triggering the `onerror` event and executing `alert(1)`, solving the lab.

