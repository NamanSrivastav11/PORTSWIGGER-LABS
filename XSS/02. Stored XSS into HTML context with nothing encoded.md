## LAB DESCRIPTION

<img width="911" height="374" alt="image" src="https://github.com/user-attachments/assets/bfee478a-1458-48a5-8e89-11f0fd6de5da" />

## SOLUTION

---------------------------------------------

- Reference: https://portswigger.net/web-security/cross-site-scripting
- XSS Cheat sheet: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet

---------------------------------------------

When you open a blog post and scroll to the bottom, there is a comment form with fields like **Name**, **Email**, **Website**, and **Comment**.

Submitting a normal comment causes it to be saved and then displayed under the post; inspecting the HTML shows that the comment body appears directly inside an HTML element with no escaping of `<` or `>`.

Because the comment field is rendered in plain HTML body context with nothing encoded.

<img width="1677" height="1042" alt="image" src="https://github.com/user-attachments/assets/24ce3bff-34b4-45cd-ac2f-0b66095697b3" />


Hence, a `<script>` block placed in the comment will execute for every user who loads the blog post.

<img width="1676" height="1108" alt="image" src="https://github.com/user-attachments/assets/58e15d54-a202-42a4-9b97-1a1876478d63" />

This can be confirmed by entering a dummy comment: 
> <img width="809" height="223" alt="image" src="https://github.com/user-attachments/assets/51de7be3-cde3-4326-a986-e73e976e9d0c" />

To exploit the vulnerability, we can submit a comment whose body is a script tag calling `alert`.
After posting the comment and returning to the blog post page, the application renders your stored comment.
Because the comment body is inserted unencoded into the HTML, the browser parser the `<script>` tag and executes `alert(1)`, displaying a JavaScript alert and solving the lab.

<img width="1841" height="1108" alt="image" src="https://github.com/user-attachments/assets/101e1d1a-e925-44ba-8666-b3a1919a3f08" />

--------------------------------------------------

Now, we can send our script in the comment field and it will be stored server-side.

<img width="1682" height="1100" alt="image" src="https://github.com/user-attachments/assets/ab52c6cb-9835-43f0-80ea-928c65c3dd6e" />

Unlike reflected XSS, the malicious payload is stored sever-side and affects every user viewing the page.

<img width="1682" height="555" alt="image" src="https://github.com/user-attachments/assets/aecb7c13-08c4-42ef-a6d3-c5cd2d2c0372" />

As the page is opened again, our script is executed as well.

<img width="1677" height="825" alt="image" src="https://github.com/user-attachments/assets/d56b5252-1b3d-4dc0-b8ac-23bcfd0ef9c1" />
