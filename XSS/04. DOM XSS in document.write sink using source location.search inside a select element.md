## LAB DESCRIPTION

<img width="938" height="501" alt="image" src="https://github.com/user-attachments/assets/647dbf73-61bd-4b18-a20a-225c05515d7f" />

## SOLUTION

---------------------------------------------

- Reference: https://portswigger.net/web-security/cross-site-scripting
- XSS Cheat sheet: https://portswigger.net/web-security/cross-site-scripting/cheat-sheet
- Common sinks for finding XSS Vulnerabilities: https://portswigger.net/web-security/cross-site-scripting/dom-based#which-sinks-can-lead-to-dom-xss-vulnerabilities

---------------------------------------------

<img width="1633" height="1084" alt="image" src="https://github.com/user-attachments/assets/f6186428-3914-45fa-81c7-f9e0c23f3cb7" />

> On a product page, open Developer Tools -> View Source and look for the stock check form.
>
> <img width="1919" height="1110" alt="image" src="https://github.com/user-attachments/assets/b388d036-cfe3-4858-8d44-cd038420848d" />

**Source**: `store` comes from `window.location.search` via `URLSearchParams(..).get('storeId')`, so we can control it via URL.
**Sink**: `document.write` injects a `<select>` with `<option>` tags into the DOM, and when `store` is present it directly embeds our value as an `<option> value` and inner text.

This means our `storeId` string will end up inside a `<select>` element.

-----------------------------------------------------------------

As our payload is written into the `<select>` via `document.type`:
- Close the current `<option>`.
- Close the `<select>` element.
- Inject the element with an event handler that will execute JavaScript `</option><script>alert(1)</script><option%20selected>`

<img width="1397" height="686" alt="image" src="https://github.com/user-attachments/assets/ca3200b9-8065-4b6b-8560-8889dbab1c2a" />

-----------------------------------------------------------------

As soon as the page loads with this crafted `storeId`, the browser parses the HTML and executes `alert(1)`, solving the lab.

<img width="1267" height="972" alt="image" src="https://github.com/user-attachments/assets/fa3552b7-e04b-40fd-9d88-0a44c4d32a23" />

