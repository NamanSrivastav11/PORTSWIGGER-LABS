## LAB DESCRIPTION

<img width="912" height="609" alt="image" src="https://github.com/user-attachments/assets/8dc04c8d-1504-400e-a5c8-e251b3fc3dd2" />

## SOLUTION

---------------------------------------------

- Reference: https://portswigger.net/web-security/csrf

---------------------------------------------

- Login as the provided user `wiener:peter` and go to **My account** -> **Update email**.

<img width="1711" height="695" alt="image" src="https://github.com/user-attachments/assets/5ac8cafe-d15d-4a1e-b316-ad69488d423d" />

- With Burp running, change the email to a dummy email and intercept the request.

  <img width="1220" height="418" alt="image" src="https://github.com/user-attachments/assets/1cab1f49-8f35-4665-8c37-9e41ed16faa6" />

-----------------------------------------------

Now we'll test the CSRF token:

- Modify `CSRF` token and resend -> server responds "Invalid CSRF token".

  <img width="1235" height="539" alt="image" src="https://github.com/user-attachments/assets/59d8c0cb-fe49-4c49-bf2b-aaf98549e709" />

- Remove the `CSRF` parameter entirely and resend as POST -> server again rejects the request.

  <img width="1233" height="539" alt="image" src="https://github.com/user-attachments/assets/5f17da66-eb80-4534-9fb8-f6a9fcbbc28c" />

Conclusion: The server validates the CSRF token for POST requests.

----------------------------------------------------------
