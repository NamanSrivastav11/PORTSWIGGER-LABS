## LAB DESCRIPTION

<img width="900" height="469" alt="image" src="https://github.com/user-attachments/assets/127d627e-6a73-4fa4-915e-ee1de6bdc996" />

--------------------------------------------

## SOLUTION

Reference: https://portswigger.net/web-security/sql-injection

---------------------------------------------
This lab demonstrates a SQL injection vulnerability in a stock check feature where parameters are submitted as XML in the request body. A web application firewall (WAF) is in place and blocks obvious SQL injectino patterns, so the attack requires obfuscation via XML encoding to bypass the filter. The backing database contains a `users` table 
with usernames and passwords, and the objective is to retrieve the administrator's credentials and log in as that user.

<img width="1918" height="1106" alt="image" src="https://github.com/user-attachments/assets/79d6d17c-98bc-43c7-9016-05fcc21c0894" />

-----------------------------------

The vulnerable functionality is the "Check Stock" feature, which sends a `POST /product/stock` request with an XML body containing `productId` and `storeId` elements

The server uses the `storeId` value in a SQL query withot proper parameterization, and the response includes data derived from that query, enabling a UNION-based injection to exfilterate arbitrary data.

**Response**

```
POST /product/stock HTTP/2
Host: 0a360099034c5005812af7ba00140069.web-security-academy.net
Cookie: session=GfztEl4SWfB5j6BteVrXMo1v0XBO20ni
Content-Length: 108
Sec-Ch-Ua-Platform: "Windows"
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/142.0.0.0 Safari/537.36
Sec-Ch-Ua: "Chromium";v="142", "Google Chrome";v="142", "Not_A Brand";v="99"
Content-Type: application/xml
Sec-Ch-Ua-Mobile: ?0
Accept: */*
Origin: https://0a360099034c5005812af7ba00140069.web-security-academy.net
Sec-Fetch-Site: same-origin
Sec-Fetch-Mode: cors
Sec-Fetch-Dest: empty
Referer: https://0a360099034c5005812af7ba00140069.web-security-academy.net/product?productId=11
Accept-Encoding: gzip, deflate, br
Accept-Language: en-US,en;q=0.9
Priority: u=1, i

<?xml version="1.0" encoding="UTF-8"?>
  <stockCheck>
        <productId>
              11
        </productId>
        <storeId>
              2
        </storeId>
  </stockCheck>
```

