## LAB DESCRIPTION

<img width="911" height="587" alt="image" src="https://github.com/user-attachments/assets/fb893769-8936-4bee-9e67-5fd340291b0d" />

## SOLUTION

---------------------------------------------

- Reference: https://portswigger.net/web-security/sql-injection
- SQL Injection Cheat sheet: https://portswigger.net/web-security/sql-injection/cheat-sheet

---------------------------------------------

The vulnerable input is the `TrackingId` cookie, which is concatenated into a SQL query that checks for a matching session or tracking record.
If the query returns at least one row, the response includes a `Welcome back` messagel; if it returns no rows, the message is missing.

<img width="846" height="444" alt="image" src="https://github.com/user-attachments/assets/78fe2569-93b0-41ba-a4a4-5f041e655d1f" />


We can confirm this by injecting always-true and always-false conditions:

- True condition:
  `TrackingId=xyz AND '1'='1` -> response still shows `Welcome back`.
  
  <img width="1881" height="958" alt="image" src="https://github.com/user-attachments/assets/9dc256f5-0115-46f2-ba66-d2e97c93f029" />

-False condition:
 `TrackingID=xyz AND '1'='2` -> `Welcome back` disappears.

 <img width="1889" height="986" alt="image" src="https://github.com/user-attachments/assets/56858c8a-a59c-43ee-acfc-ed9376d074e2" />

---------------------------------------------------

**Confirming `administrator` exists**

Use the boolean oracle to check that a user named `administrator` is present.

PAYLOAD: `TrackingId=xyz' AND (SELECT 'a' FROM users WHERE username='administrator')='a`

  <img width="1688" height="793" alt="image" src="https://github.com/user-attachments/assets/0db51301-4cdf-44e0-b9bd-21690e8182fa" />

-As `Welcome back` is shown, it means the subquery returned a row and the condition is true.

This validates that we can reference the `users` table and that `administrator` is a valid user.

----------------------------------------------------

**Determine password length**

Use `boolean` conditions on `LENGTH(password)`.

PAYLOAD: `' and (SELECT username FROM users WHERE username='administrator' AND LENGTH(password)>1)='administrator'-- `

> Check with '>' instead of '='. It results in the "Welcome back" message meaning the password is longer than 1 character.

<img width="1302" height="709" alt="image" src="https://github.com/user-attachments/assets/edc5cd6a-f615-4cf4-a5f1-b8c371867ca7" />



**USING BURPSUITE TO BRUTEFORCE THE LENGTH**

> Send the request from Repeater to Intruder
> Modify the request by adding a selection on the length part of the query.
> Select attack type as `Sniper` and configure the payload as `Numbers` and give a range.
> 
> <img width="1602" height="893" alt="image" src="https://github.com/user-attachments/assets/a513b8a2-f4cd-4b09-a235-54256f475485" />
>
> Under the Settings tab, scroll down to `Grep - Match` section and add the keyword `Welcome back`.
>
> <img width="1586" height="893" alt="image" src="https://github.com/user-attachments/assets/244166e9-9037-450b-90aa-941801d62c0f" />
>
> After that start the attack.

<img width="1920" height="1152" alt="image" src="https://github.com/user-attachments/assets/7553ac2e-2e95-4c5a-99ba-8b2632f83529" />

> Password is exactly 20 characters long.

--------------------------------------------------

**Extracting password characters (SUBSTRING)**

Use a boolean condition to test each position and candidate character.

PAYLOAD: `' and (select substring(password,1,1) from users where username='administrator')='a'--`

<img width="1589" height="893" alt="image" src="https://github.com/user-attachments/assets/68da98fe-53c3-4dff-ab99-e71f4f0d1ceb" />

It can be confirmed that 'a' is not the first character; further we can automate this process by using Burp Suite Intruder.

  <img width="1924" height="1152" alt="image" src="https://github.com/user-attachments/assets/0db6d9b4-cd7e-4ce9-9a43-4f1793825894" />
  
Hence, the first character is confirmed to be `2`


